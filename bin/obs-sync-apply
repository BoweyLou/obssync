#!/bin/bash
# Convenience script to run sync_links_apply.py with the correct Python environment

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
WORK_DIR="$(dirname "$SCRIPT_DIR")"
PYTHON_BIN="$HOME/Library/Application Support/obs-tools/venv/bin/python3"
SYNC_SCRIPT="$WORK_DIR/obs_tools/commands/sync_links_apply.py"

# Check if the Python binary exists
if [[ ! -f "$PYTHON_BIN" ]]; then
    echo "Error: obs-tools Python environment not found at $PYTHON_BIN"
    echo "Please ensure obs-tools is properly installed."
    exit 1
fi

# Check if the sync script exists
if [[ ! -f "$SYNC_SCRIPT" ]]; then
    echo "Error: sync_links_apply.py not found at $SYNC_SCRIPT"
    exit 1
fi

# Run the sync script with the correct Python and pass all arguments
# Change to the work directory so imports work correctly
cd "$WORK_DIR"
exec "$PYTHON_BIN" "$SYNC_SCRIPT" "$@"